# 5장 책임 할당하기

## Reference

- [오브젝트 - 조영호 저자(글)](https://product.kyobobook.co.kr/detail/S000001766367)

책임에 초점을 맞춰서 설계할 때 직면하는 가장 큰 어려움은 어떤 객체에게 어떤 책임을 할당할지를 결정하기가 쉽지 않다는 것이다. 책임 할당 과정은 일종의 트레이드 오프 활동이다. 동일한 문제를 해결할 수 있는 다양한 책임 할당 방법이 존재하고, 어떤 방법이 최선인지는 상황과 문맥에 따라 달라진다.

## 책임 주도 설계를 향해

- 데이터보다 행동을 먼저 결정해라
- 협력이라는 문맥 안에서 책임을 결정하라

## 데이터보다 행동을 먼저 결정해라

객체에게 중요한 것은 테이터가 아니라 외부에 제공하는 행동이다. 클라이언트의 관점에서 객체가 숳애하는 행동이란 곧 객체의 책임을 의미한다. 객체는 협력에 참여하기 위해 존재하고, 협력 안에서 수행하는 책임이 객체의 존재가치를 증명한다.

책임 중심의 설계에서는 이 객체가 수행해야 하는 책임은 무엇인가?를 결정한 후 이 책임을 수행하는 데 필요한 데이터는 무엇인가를 결정한다.

## 협력이라는 문맥 안에서 책임을 결정하라

객체에게 할당된 책임의 품질은 협력에 적합한 정도로 결정된다. 객체의 입장에서 책임이 조금 어색해 보이더라도 협력에 적합하다면 그 책임은 좋은 것이다. 책임은 객체의 입장이 아니라 객체가 참여하는 협력에 적합해야 한다. 협력에 적합한 책임을 수행하기 위해서는 객체를 결정한 후에 메시지를 선택하는 것이 아니라 메시지를 결정한 후에 객체를 선택해야 한다.

## 책임 주도 설계

- 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
- 시스템 책임을 더 작은 책임으로 분할한다.
- 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
- 객체가 책임을 수행하는 도중 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
- 해당 객체 또는 역할에게 할당함으로써 두 객체가 협력하게 된다.

## 책임 할당을 위한 GRASP 패턴

GRASP 패턴은 일반적인 책임 할당을 위한 소프트웨어 패턴의 약자로 객체에게 책임을 할당할 때 지침으로 삼을 수 있는 원칙들의 집합을 패턴 형식으로 정리한 것이다.

## 도메인 개념에서 출발하기

설계를 시작하기 전에 도메인에 대한 개략적인 모습을 그려 보는 것이 유용하다. 도메인 안에는 무수히 많은 개념들이 존재하고, 이 도메인 개념을 책임 할당의 대상으로 사용하면 코드에 도메인의 모습을 투영하기 수월해진다.

설계를 시작하는 단계에서 개념들의 의미와 관계가 정확하거나 완벽할 필요가 없다. 도메인 개념을 정리하는 데 너무 많은 시간을 들이지 말고 빠르게 설계와 구현을 진행해라.

## 정보 전문가에게 책임을 할당하라

책임 주도 설계 방식의 첫 단계는 애플리케이션이 제공해야 하는 기능을 애플리케이션의 책임으로 생각하는 것이다. 이 책임을 애플리케이션에 대해 전송된 메시지로 간주하고 이 메시지를 책임질 첫 번째 객체를 선택하는 것으로 설계를 시작한다.

객체에게 책임을 할당하는 첫 원칙은 책임을 수행할 정보를 알고 있는 객체에게 책임을 할당하는 것이다. 이를 정보 전문가 패턴이라 한다. 정보 전문가 패턴은 객체가 자신이 소유하고 있는 정보와 관련된 작업을 수행한다는 일반적인 직관을 표현한 것이다.

## 높은 응집도와 낮은 결합도

설계는 트레이드오프 활동이다. 동일한 기능을 구현할 수 있는 무수히 많은 설계가 존재한다. 여러 설계중 높은 응집도와 낮은 결합도를 얻을 수 있는 설계가 있다면 그 설계를 선택해야 한다.

## 창조자에게 객체 생성 책임을 할당하라

GRASP의 CREATOR패턴은 객체 생성할 책임을 어떤 객체에게 할당할지에 대한 지침을 제공한다.

## 책임 주도 설계의 대안

책임 주도 설계에 익숙해지기 위해서는 많은 노력과 시간이 필요하다. 설계를 진행하는 동안 데이터가 아닌 책임 관점에서 사고하기 위해서는 충분한 경험과 학습이 필요하다.

방황할때 돌파구는 최대한 빠르게 목적한 기능을 수행하는 코드를 작성하는 것이다.

주의할 점은 코드를 수정한 후에 겉으로 드러나는 동작이 바뀌어서는 안된다는 것이다. 캡슐화를 향상시키고, 응집도를 높이고, 결합도를 낯춰야 하지만 동작은 그대로 유지해야 한다. 이처럼 이해하기 쉽고 수정하기 쉬운 소프트웨어로 개선하기 위해 겉으로 보이는 동작은 바꾸지 않은 채 내부 구조를 변경하는 것을 리팩터링이라 부른다.

## 메서드 응집도

응집도가 낮은 메서드는 로직의 흐름을 이해하기 위해 주석이 필요한 경우가 대부분이다. 메서드가 명령문들의 그룹으로 구성되고 각 그룸에 주석을 달아야 할 필요가 있다면 그 메서드의 응집도는 낟은 것이다. 주석을 추가하는 대신 메서드를 작게 분해해서 각 메서드의 응집도를 높여라

## 객체를 자율적으로 만들자

객체가 자율적인 존재여야 한다는 사실을 떠올리면 쉽게 답할 수 있을 것이다. 자신이 소유하고 있는 데이터를 자기 스스로 처리하도록 만드는 것이 자율적인 객체를 만드는 지름길이다. 메서드가 사용하고 있는 데이터를 저장하고 있는 클래스로 메서드를 이동시키면 된다.